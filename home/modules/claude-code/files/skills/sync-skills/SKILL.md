---
name: sync-skills
description: Read all skills from skills/ directory and update the Skills section in CLAUDE.md to stay in sync. Run this after adding, removing, or modifying skills.
context: fork
allowed-tools: Read, Edit, Write, Glob, Grep, Bash(find -L *)
---

# Sync Skills

Sync skill lists in CLAUDE.md files with the actual skill definitions on disk.

## Targets

Run the following procedure for each target. Skip a target if its skills directory does not exist or is empty.

| Target | Skills dir | CLAUDE.md file | Section heading |
|--------|-----------|----------------|-----------------|
| Global | `skills/` | `CLAUDE.md` | `## Skills (auto-generated by /sync-skills)` |
| Project | `.claude/skills/` | `.claude/CLAUDE.md` | `## Project Skills (auto-generated by /sync-skills)` |

## Procedure (per target)

1. Run `find -L {skills_dir} -maxdepth 2 -name SKILL.md` via Bash to discover all SKILL.md files (follows symlinks). Parse `name` and `description` from YAML frontmatter of each found file.
   <!-- FIXME: Glob does not follow symlinks, so we use find -L instead. Revert to Glob and remove Bash from allowed-tools once Glob gains symlink support. -->
2. Generate the section body:
   - Start with the intro paragraph: `When a task matches a skill below, you MUST invoke it via the Skill tool BEFORE taking any other action. Pay attention to override instructions (what NOT to do) in each entry.`
   - Then one `- /name — summary` line per skill, sorted alphabetically
   - Each summary is derived from the `description` field in SKILL.md frontmatter. It MUST include all of the following that are present in the description: (1) when to use the skill (trigger conditions), (2) what it does, (3) any override instructions (what NOT to do instead). Condense for readability, but never drop trigger conditions or override instructions. Write in English only.
3. For the Global target, append the existing `Notes:` block unchanged at the end of the section
4. Compare with the existing section in the target CLAUDE.md. Update only if there are differences.
5. Replace the section (from heading up to the next `## `) in-place. If the section doesn't exist: Global → add at top of file, Project → add immediately before `## Directory Structure`. Only modify the target section — preserve everything else.
